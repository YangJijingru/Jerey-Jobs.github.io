---
tags: 
 - 数论-欧拉函数
grammar_cjkRuby: true
catalog: true
layout:  post
header-img: "img/header/P26.jpg"
preview-img: "/img/preview/P66.jpg"
---
<p>
	<strong><span style="font-family:等线;font-size:16px;">标签：欧拉函数，数论</span></strong>
</p>
<p>
	<strong><span style="font-family:等线;font-size:16px;">Description</span></strong>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">Longge的数学成绩非常好，并且他非常乐于挑战高难度的数学问题。现在问题来了：给定一个整数N，你需要求出∑gcd(i, N)(1&lt;=i &lt;=N)。</span>
</p>
<p>
	<strong><span style="font-family:等线;font-size:16px;">Input</span></strong>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">一个整数，为N。</span>
</p>
<p>
	<strong><span style="font-family:等线;font-size:16px;">Output</span></strong>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">一个整数，为所求的答案。</span>
</p>
<p>
	<strong><span style="font-family:等线;font-size:16px;">Sample Input</span></strong>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">6<br />
	</span><br />
	
</p>
<p>
	<strong><span style="font-family:等线;font-size:16px;">Sample Output</span></strong>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">15<br />
	</span><br />
	
</p>
<p>
	<strong><span style="font-family:等线;font-size:16px;">HINT</span></strong>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">【数据范围】<br />
	对于60%的数据，0&lt;N&lt;=2^16。<br />
	对于100%的数据，0&lt;N&lt;=2^32。</span>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">&nbsp;</span>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">分析：</span>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">对于gcd(I,N)，设x为N的约数</span>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">∑gcd(I,N)=∑phi(N/x)*x</span>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">求phi的时候要用O（√n）的算法</span>
</p>
<p>
	<span style="font-family:等线;font-size:16px;">Code</span>
</p>
<pre class="cpp" name="code">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;algorithm&gt;
#define LL long long
#define rep(i,a,b) for(LL i=a;i&lt;=b;i++)
#define dep(i,a,b) for(LL i=a;i&gt;=b;i--)
#define mem(x,num) memset(x,num,sizeof x)
using namespace std;
long long n,ans,m;
LL phi(LL x)
{
	LL t=x;
	rep(i,2,m)
	    if(x%i==0){
			t=t/i*(i-1);
			while(x%i==0)x/=i;
		}
	if(x&gt;1)t=t/x*(x-1);
	return t;
}

int main()
{
	cin&gt;&gt;n;
	m=sqrt(n);
	rep(i,1,m)
		if(n%i==0){
			ans+=i*phi(n/i);
			if(i*i&lt;n)ans+=(n/i)*phi(i);
			}
	cout&lt;&lt;ans&lt;&lt;endl;
	return 0;
}</pre>
<br />

<p>
	<br />
	
</p>
