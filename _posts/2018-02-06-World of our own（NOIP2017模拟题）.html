---
tags: 
 - 特殊-位运算
 - 数论-组合数
grammar_cjkRuby: true
catalog: true
layout:  post
header-img: "img/header/P14.jpg"
preview-img: "/img/preview/P54.jpg"
---
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">标签：数论，前缀和，位运算</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><br />
	</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">小</span><span style="color:#333333;">C</span><span style="color:#333333;">在研究数组的</span><span style="color:#333333;">xor</span><span style="color:#333333;">。</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">她有一个长度为</span><span style="color:#333333;">n</span><span style="color:#333333;">的数组</span><span style="color:#333333;">A</span><span style="color:#333333;">。</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">她每次会把</span><span style="color:#333333;">ai−1</span><span style="color:#333333;">和</span><span style="color:#333333;">ai</span><span style="color:#333333;">异或起来，然后</span><span style="color:#333333;">A</span><span style="color:#333333;">的长度会变成</span><span style="color:#333333;">n−1</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">这么操作了</span><span style="color:#333333;">n−1</span><span style="color:#333333;">次之后得到了长度为</span><span style="color:#333333;">1</span><span style="color:#333333;">的数组。</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">她想知道在操作过程中每次的</span><span style="color:#333333;">a1</span><span style="color:#333333;">为多少</span><span style="color:#333333;">?</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">为了避免输出过大，请输出第</span><span style="color:#333333;">j</span><span style="color:#333333;">次操作后的</span><span style="color:#333333;">a</span><span style="color:#333333;">1</span><span style="color:#333333;">×(</span><span style="color:#333333;">j</span><span style="color:#333333;">+</span><span style="color:#333333;">1</span><span style="color:#333333;">)</span><span style="color:#333333;">的异或和</span><span style="color:#333333;">(</span><span style="color:#333333;">0</span><span style="color:#333333;">≤</span><span style="color:#333333;">j≤n−1</span><span style="color:#333333;">)</span><span style="color:#333333;">。</span></span>
</p>
<h3>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">输入格式</span></span>
</h3>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">一行五个整数</span><span style="color:#333333;">n,a,b,c,d</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">数组</span><span style="color:#333333;">A</span><span style="color:#333333;">以如下方式生成，</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;"><img src="http://xheditor.com/js/xheditor_skin/default/img/waiting.gif" remoteimg="0" alt="" /><br />
	</span></span>
</p>
<h3>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">输出格式</span></span>
</h3>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">一行一个整数表示答案。</span></span>
</p>
<h3>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">样例一</span></span>
</h3>
<h4>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">input</span></span>
</h4>
<div style="background:whitesmoke">
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">5 3 2 4 15</span></span></pre>
</div>
<h4>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">output</span></span>
</h4>
<div style="background:whitesmoke">
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">89</span></span></pre>
</div>
<h3>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">样例解释</span></span>
</h3>
<div style="background:whitesmoke">
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">3 4 13 4 13 </span></span></pre>
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">7 9 9 9</span></span></pre>
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">14 0 0</span></span></pre>
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">14 0</span></span></pre>
	<pre style="background:whitesmoke"><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">14</span></span></pre>
</div>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">3</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">xor</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">(</span><span style="color:#333333;">7</span><span style="color:#333333;">∗</span><span style="color:#333333;">2</span><span style="color:#333333;">)</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">xor</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">(</span><span style="color:#333333;">14</span><span style="color:#333333;">∗</span><span style="color:#333333;">3</span><span style="color:#333333;">)</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">xor</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">(</span><span style="color:#333333;">14</span><span style="color:#333333;">∗</span><span style="color:#333333;">4</span><span style="color:#333333;">)</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">xor</span><span style="color:#333333;">&nbsp;</span><span style="color:#333333;">(</span><span style="color:#333333;">14</span><span style="color:#333333;">∗</span><span style="color:#333333;">5</span><span style="color:#333333;">)=</span><span style="color:#333333;">89</span></span>
</p>
<h3>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">限制于约定</span></span>
</h3>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><img src="http://xheditor.com/js/xheditor_skin/default/img/waiting.gif" remoteimg="1" alt="" /></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><br />
	</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">分析：</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">30分&nbsp;&nbsp; 直接暴力模拟</span>
</p>
<pre name="code" class="cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;

const int maxn=1e5+5;
unsigned long long n,a,b,c,d,ans;
unsigned long long x[maxn],y[maxn];
int main()
{
//	scanf(&quot;%I64d%I64d%I64d%I64d%I64d&quot;,&amp;n,&amp;a,&amp;b,&amp;c,&amp;d);
	cin&gt;&gt;n&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d;
	x[1]=a;
	for(int i=2;i&lt;=n;i++)x[i]=((x[i-1]*x[i-1])+b*x[i-1]+c)%d;
	for(int i=1;i&lt;=n;i++)
	{
		ans=ans^(x[1]*i);
		for(int j=1;j&lt;=n-i+1;j++)
		   y[j]=x[j]^x[j+1];
		memset(x,0,sizeof(0));
		for(int j=1;j&lt;=n-i;j++)x[j]=y[j];
	}
	cout&lt;&lt;ans&lt;&lt;endl;
	return 0;	
}
</pre>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">50分&nbsp;&nbsp; 经过输出每一次循环的x[]数组，不难发现，当a[2]==0时，a[1]不再发生变化，可以跳出循环，break，单独计算后面每个a[1]的异或和</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">Code</span>
</p>
<pre name="code" class="cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;

const int maxn=8000005;
unsigned long long n,a,b,c,d,ans;
unsigned long long x[maxn],y[maxn];

int main()
{
	cin&gt;&gt;n&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d;
	x[1]=a;
	for(int i=2;i&lt;=n;i++)x[i]=((x[i-1]*x[i-1])+b*x[i-1]+c)%d;
	int i;
	for(i=1;i&lt;=n;i++)
	{
		ans=ans^(x[1]*i);
		for(int j=1;j&lt;=n-i+1;j++)
		   y[j]=x[j]^x[j+1];
		memset(x,0,sizeof(0));
		for(int j=1;j&lt;=n-i;j++)x[j]=y[j];
		if(x[2]==0)break;
	}
	for(int k=i+1;k&lt;=n;k++)ans=ans^(x[1]*k);
	cout&lt;&lt;ans&lt;&lt;endl;
	return 0;	
}
</pre>
<br />

<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">100分&nbsp;&nbsp; 这题的求解过程可以看成每次在A当前位置上方和右上方的数的异或，并且每次长度减1，等价于有多少种方案走到这个位置，假设A当前位置为i+1一个点为第j个数列的第一项，那么从i到j会向下走j步，向左走i步，方案数为C(I,j)，</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">那么第j个数列的第1项就是C(0,j)个a[1],C(1,j)个a[2],C(I,j)个a[i+1]~C(j,j)个a[j+1]的异或</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">如果i到j有奇数个方案，那么i到j就有贡献，否则没有，考虑C（I,j）的奇偶性</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">根据lucas定理，<img src="http://xheditor.com/js/xheditor_skin/default/img/waiting.gif" remoteimg="2" alt="" /></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">C（I mod 2,j mod 2）=0当且仅当j mod 2=0而I mod 2=1，那么C（I,j）为奇数当且仅当每个二进制位都没有这种情况，即I and j=i</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">对于每个j的答案，记为b[j]，它等于所有满足I and j=i的a[i]的异或和</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">注意到这里的子集可以看做高维的前缀和，可以看成数组a有m堆，每一堆都是0或1，表示下标的一个二进制位，我们要对a一个m维的前缀和得到b，b[j]就是把j中一些1的位变成0得到i的a[i]的和</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">时间复杂度为O（n log n），那么大的数据范围，这也能水过？？？23333超神的评测机</span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;">Code</span>
</p>
<pre name="code" class="cpp">#include&lt;bits/stdc++.h&gt;
#define LL long long
using namespace std;
const int maxn=(1&lt;&lt;23)+7;
int n,a,b,c,d;
LL x[maxn];

int main()
{
	cin&gt;&gt;n&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d;
	x[0]=a;
	for(int i=1;i&lt;n;i++)x[i]=(1LL*x[i-1]*x[i-1]+1LL*b*x[i-1]+c)%d;
	for(int j=0;j&lt;23;j++)
	    for(int i=0;i&lt;n;i++)
	        if(!(i&gt;&gt;j&amp;1))x[i|(1&lt;&lt;j)]^=x[i];
	LL ans=0;
	for(int i=0;i&lt;n;i++)ans^=1LL*(i+1)*x[i];
	cout&lt;&lt;ans&lt;&lt;endl;
	return 0;
}
</pre>
<br />
<br />
<br />
<br />
<br />