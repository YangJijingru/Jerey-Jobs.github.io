---
tags: 
 - 数论-组合数
grammar_cjkRuby: true
catalog: true
layout:  post
header-img: "img/header/P30.jpg"
preview-img: "/img/preview/P70.jpg"
---
<p style="margin:0px">
	<strong><span style="font-family:等线;font-size:16px;">标签：<span style="margin:0px" lang="EN-US">Lucas</span>定理，数学，逆元</span></strong>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">Description</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-weight:bold"><span style="font-family:等线;"><span style="font-size:16px;"><span style="margin:0px" lang="EN-US">LMZ</span>有<span style="margin:0px" lang="EN-US">n</span>个不同的基友，他每天晚上要选<span style="margin:0px" lang="EN-US">m</span>个进行<span style="margin:0px" lang="EN-US">[</span>河蟹<span style="margin:0px" lang="EN-US">]</span>，而且要求每天晚上的选择都不一样。那么<span style="margin:0px" lang="EN-US">LMZ</span>能够持续多少个这样的夜晚呢？当然，<span style="margin:0px" lang="EN-US">LMZ</span>的一年有<span style="margin:0px" lang="EN-US">10007</span>天，所以他想知道答案<span style="margin:0px" lang="EN-US">mod 10007</span>的值。<span style="margin:0px" lang="EN-US">(1&lt;=m&lt;=n&lt;=200,000,000)</span></span></span></span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">Input</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-weight:bold"><span style="font-family:等线;"><span style="font-size:16px;"><span style="margin:0px" lang="EN-US">&nbsp;</span>第一行一个整数<span style="margin:0px" lang="EN-US">t</span>，表示有<span style="margin:0px" lang="EN-US">t</span>组数据。<span style="margin:0px" lang="EN-US">(t&lt;=200)</span></span></span></span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="font-weight:bold"><span style="font-family:等线;"><span style="font-size:16px;"><span style="margin:0px" lang="EN-US">&nbsp;</span>接下来<span style="margin:0px" lang="EN-US">t</span>行每行两个整数<span style="margin:0px" lang="EN-US">n, m</span>，如题意。</span></span></span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">Output</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-weight:bold"><span style="font-family:等线;"><span style="font-size:16px;"><span style="margin:0px" lang="EN-US">T</span>行，每行一个数，为<span style="margin:0px" lang="EN-US">C(n,m) mod 10007</span>的答案。</span></span></span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">Sample Input</span></span></strong>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">4</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">5 1</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">5 2</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">7 3</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">4 2</span></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">Sample Output</span></span></strong>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">5</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">10</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">35</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">6</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">&nbsp;</span></span>
</p>
<p style="margin:0px">
	<span style="font-family:等线;font-size:16px;">分析：<span style="margin:0px" lang="EN-US">C(n,m)</span>直接套用<span style="margin:0px" lang="EN-US">lucas</span>定理和逆元的裸题</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:等线;font-size:16px;">Code</span></span>
</p>
<pre class="cpp" name="code">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;algorithm&gt;
#define rep(i,a,b) for(int i=a;i&lt;=b;i++)
#define dep(i,a,b) for(int i=a;i&gt;=b;i--)
#define mem(x,num) memset(x,num,sizeof x)
#define LL long long
using namespace std;
inline LL read()
{
	LL f=1,x=0;char ch=getchar();
	while(ch&lt;'0'||ch&gt;'9'){if(ch=='-')f=-1;ch=getchar();}
	while(ch&gt;='0'&amp;&amp;ch&lt;='9'){x=x*10+ch-'0';ch=getchar();}
	return x*f;
}
const int p=10007;
int fac[p],inv[p],n,m,T;
void work()
{
	fac[0]=fac[1]=inv[0]=inv[1]=1;
	rep(i,2,p-1)fac[i]=fac[i-1]*i%p;
	rep(i,2,p-1)inv[i]=(p-p/i)*inv[p%i]%p;
	rep(i,1,p-1)inv[i]=inv[i-1]*inv[i]%p;
}

int C(int n,int m)
{
	if(n&lt;m)return 0;
	if(n&lt;p&amp;&amp;m&lt;p)return fac[n]*inv[m]%p*inv[n-m]%p;
	return C(n/p,m/p)*C(n%p,m%p)%p;
}

int main()
{
	work();
	T=read();
	while(T--)
	{
		n=read(),m=read();
		printf(&quot;%d\n&quot;,C(n,m));
	}
	return 0;
}</pre>
<br />

<p>
	<br />
	
</p>
