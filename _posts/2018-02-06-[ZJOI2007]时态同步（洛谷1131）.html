---
tags: 
 - DP-树形
grammar_cjkRuby: true
catalog: true
layout:  post
header-img: "img/header/P10.jpg"
preview-img: "/img/preview/P10.jpg"
---
<h1>
	<span style="font-family:Microsoft YaHei;font-size:16px;">标签：树形DP</span>
</h1>
<h2>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">题目描述</span></span>
</h2>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">小Q在电子工艺实习课上学习焊接电路板。一块电路板由若干个元件组成，我们不妨称之为节点，并将其用数字1,2,3….进行标号。电路板的各个节点由若干不相交的导线相连接，且对于电路板的任何两个节点，都存在且仅存在一条通路（通路指连接两个元件的导线序列）。</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">在电路板上存在一个特殊的元件称为“激发器”。当激发器工作后，产生一个激励电流，通过导线传向每一个它所连接的节点。而中间节点接收到激励电流后，得到信息，并将该激励电流传向与它连接并且尚未接收到激励电流的节点。最终，激烈电流将到达一些“终止节点”――接收激励电流之后不再转发的节点。</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">激励电流在导线上的传播是需要花费时间的，对于每条边e，激励电流通过它需要的时间为te，而节点接收到激励电流后的转发可以认为是在瞬间完成的。现在这块电路板要求每一个“终止节点”同时得到激励电路――即保持时态同步。由于当前的构造并不符合时态同步的要求，故需要通过改变连接线的构造。目前小Q有一个道具，使用一次该道具，可以使得激励电流通过某条连接导线的时间增加一个单位。请问小Q最少使用多少次道具才可使得所有的“终止节点”时态同步？</span></span>
</p>
<h2>
	<strong><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">输入输出格式</span></span></strong>
</h2>
<p>
	<strong><span style="color:#515151;"><span style="font-family:Microsoft YaHei;font-size:16px;">输入格式：</span></span></strong>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">第一行包含一个正整数N，表示电路板中节点的个数。</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">第二行包含一个整数S，为该电路板的激发器的编号。</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">接下来N-1行，每行三个整数a , b , t。表示该条导线连接节点a与节点b，且激励电流通过这条导线需要t个单位时间。</span></span>
</p>
<p>
	<strong><span style="color:#515151;"><span style="font-family:Microsoft YaHei;font-size:16px;">输出格式：</span></span></strong>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">仅包含一个整数V，为小Q最少使用的道具次数。</span></span>
</p>
<h2>
	<strong><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">输入输出样例</span></span></strong>
</h2>
<p>
	<strong><span style="color:#515151;"><span style="font-family:Microsoft YaHei;font-size:16px;">输入样例#1：</span></span></strong>
</p>
<p style="background:rgb(248,248,248)">
	<span style="color:#555555;"><span style="font-family:Microsoft YaHei;font-size:16px;">3</span></span>
</p>
<p style="background:rgb(248,248,248)">
	<span style="color:#555555;"><span style="font-family:Microsoft YaHei;font-size:16px;">1</span></span>
</p>
<p style="background:rgb(248,248,248)">
	<span style="color:#555555;"><span style="font-family:Microsoft YaHei;font-size:16px;">1 2 1</span></span>
</p>
<p style="background:rgb(248,248,248)">
	<span style="color:#555555;"><span style="font-family:Microsoft YaHei;font-size:16px;">1 3 3</span></span>
</p>
<p>
	<strong><span style="color:#515151;"><span style="font-family:Microsoft YaHei;font-size:16px;">输出样例#1：</span></span></strong>
</p>
<p style="background:rgb(248,248,248)">
	<span style="color:#555555;"><span style="font-family:Microsoft YaHei;font-size:16px;">2</span></span>
</p>
<h2>
	<strong><span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">说明</span></span></strong>
</h2>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">对于40%的数据，N ≤ 1000</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">对于100%的数据，N ≤ 500000</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">对于所有的数据，te ≤ 1000000</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;"><br />
	</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">分析：原本以为这是一道图论题，跑最长路，结果无情</span><span style="color:#333333;">WA</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">后来过好长时间才发现这是树形DP，用dfs遍历整个树</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">F</span><span style="color:#333333;">[x]表示叶节点到x节点的最大时间</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">当每个儿子son回溯,，如果经过son到达最远叶子节点的花费时间更长，那么就更新f[x]，f[x]=max(f[x],f[son]+v) &nbsp;&nbsp;（v为x到son的花费时间，就是边权）</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">A</span><span style="color:#333333;">ns=sum(f[x]-f[son]-v)</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;">注意用long long，否则答案可能会爆int</span></span>
</p>
<p>
	<span style="color:#333333;"><span style="font-family:Microsoft YaHei;font-size:16px;"><br />
	</span></span>
</p>
<p>
	<span style="font-family:Microsoft YaHei;font-size:16px;"><span style="color:#333333;">C</span><span style="color:#333333;">ode</span></span>
</p>
<pre name="code" class="cpp">#include&lt;bits/stdc++.h&gt;
#define rep(i,a,b) for(int i=a;i&lt;=b;i++)
#define dep(i,a,b) for(int i=a;i&gt;=b;i--)
#define LL long long
using namespace std;
LL ans=0;
const int maxn=500005;
int f[maxn],last[maxn],cnt=0,n,root,u,v,w;
struct edge{int to,next,v;}e[maxn*2];
void ins(int u,int v,int w){
    e[++cnt]=(edge){v,last[u],w};
    last[u]=cnt;
    e[++cnt]=(edge){u,last[v],w};
    last[v]=cnt;
}
void dfs(int x,int father){
#define reg(x) for(int i=last[x];i;i=e[i].next)
    reg(x)
        if(e[i].to!=father){
        dfs(e[i].to,x);
        f[x]=max(f[x],f[e[i].to]+e[i].v);
    }
    reg(x)
        if(e[i].to!=father)ans+=f[x]-f[e[i].to]-e[i].v;
}
int main()
{
    scanf(&quot;%d%d&quot;,&amp;n,&amp;root);
    rep(i,1,n-1){
        scanf(&quot;%d%d%d&quot;,&amp;u,&amp;v,&amp;w);
        ins(u,v,w);
    }
    dfs(root,0);
    printf(&quot;%lld&quot;,ans);
    return 0;
}
</pre>
<br />
<br />

<p>
	<span style="color:#333333;"><br />
	</span>
</p>
