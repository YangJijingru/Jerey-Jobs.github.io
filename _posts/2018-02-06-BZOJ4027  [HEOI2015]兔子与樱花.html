---
tags: 
 - DP-树形
grammar_cjkRuby: true
catalog: true
layout:  post
header-img: "img/header/P5.jpg"
preview-img: "/img/preview/P5.jpg"
---
<p style="margin:0px">
	<strong><span style="font-family:Microsoft YaHei;"><span style="font-size:16px;">标签：树形<span style="margin:0px" lang="EN-US">DP</span></span></span></strong>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">Description</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;"><span style="font-size:16px;">很久很久之前，森林里住着一群兔子。有一天，兔子们突然决定要去看樱花。兔子们所在森林里的樱花树很特殊。樱花树由<span style="margin:0px" lang="EN-US">n</span>个树枝分叉点组成，编号从<span style="margin:0px" lang="EN-US">0</span>到<span style="margin:0px" lang="EN-US">n-1</span>，这<span style="margin:0px" lang="EN-US">n</span>个分叉点由<span style="margin:0px" lang="EN-US">n-1</span>个树枝连接，我们可以把它看成一个有根树结构，其中<span style="margin:0px" lang="EN-US">0</span>号节点是根节点。这个树的每个节点上都会有一些樱花，其中第<span style="margin:0px" lang="EN-US">i</span>个节点有<span style="margin:0px" lang="EN-US">c_i</span>朵樱花。樱花树的每一个节点都有最大的载重<span style="margin:0px" lang="EN-US">m</span>，对于每一个节点<span style="margin:0px" lang="EN-US">i</span>，它的儿子节点的个数和<span style="margin:0px" lang="EN-US">i</span>节点上樱花个数之和不能超过<span style="margin:0px" lang="EN-US">m</span>，即<span style="margin:0px" lang="EN-US">son(i) + c_i &lt;= m</span>，其中<span style="margin:0px" lang="EN-US">son(i)</span>表示<span style="margin:0px" lang="EN-US">i</span>的儿子的个数，如果<span style="margin:0px" lang="EN-US">i</span>为叶子节点，则<span style="margin:0px" lang="EN-US">son(i) = 0</span></span></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">现在兔子们觉得樱花树上节点太多，希望去掉一些节点。当一个节点被去掉之后，这个节点上的樱花和它的儿子节点都被连到删掉节点的父节点上。如果父节点也被删除，那么就会继续向上连接，直到第一个没有被删除的节点为止。</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">现在兔子们希望计算在不违背最大载重的情况下，最多能删除多少节点。</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">注意根节点不能被删除，被删除的节点不被计入载重。</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">Input</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">第一行输入两个正整数，<span style="margin:0px" lang="EN-US">n</span>和<span style="margin:0px" lang="EN-US">m</span>分别表示节点个数和最大载重</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">第二行<span style="margin:0px" lang="EN-US">n</span>个整数<span style="margin:0px" lang="EN-US">c_i</span>，表示第<span style="margin:0px" lang="EN-US">i</span>个节点上的樱花个数</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">接下来<span style="margin:0px" lang="EN-US">n</span>行，每行第一个数<span style="margin:0px" lang="EN-US">k_i</span>表示这个节点的儿子个数，接下来<span style="margin:0px" lang="EN-US">k_i</span>个整数表示这个节点儿子的编号</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">Output</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;"><span style="font-size:16px;"><span style="margin:0px" lang="EN-US">&nbsp;</span>一行一个整数，表示最多能删除多少节点。</span></span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">Sample Input</span></span></strong>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">10 4</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">0 2 2 2 4 1 0 4 1 1</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">3 6 2 3</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">1 9</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">1 8</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">1 1</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">0</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">0</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">2 7 4</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">0</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">1 5</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">0</span></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">Sample Output</span></span></strong>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">4</span></span>
</p>
<p style="margin:0px">
	<strong><span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">HINT</span></span></strong>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;"><span style="font-size:16px;">对于<span style="margin:0px" lang="EN-US">100%</span>的数据，<span style="margin:0px" lang="EN-US">1 &lt;= n&lt;= 2000000, 1 &lt;= m &lt;= 100000, 0 &lt;= c_i &lt;= 1000</span></span></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;"><span style="font-size:16px;">数据保证初始时，每个节点樱花数与儿子节点个数之和大于<span style="margin:0px" lang="EN-US">0</span>且不超过<span style="margin:0px" lang="EN-US">m</span></span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">&nbsp;</span></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">题意：给定一棵树，对于每一个节点<span style="margin:0px" lang="EN-US">i,</span>它的重量为子树中节点的个数<span style="margin:0px" lang="EN-US">+</span>自身的<span style="margin:0px" lang="EN-US">c[i]</span>值，要求每个节点都不能超过最大重量<span style="margin:0px" lang="EN-US">m</span>，问最多可以删除多少个节点</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">&nbsp;</span></span>
</p>
<p style="margin:0px">
	<span style="font-family:Microsoft YaHei;font-size:16px;">分析：自底向上贪心，删除时，每个节点选择代价最小的儿子，每个节点把儿子排序，直到不能再删为止</span><span style="margin:0px" lang="EN-US"></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">&nbsp;</span></span>
</p>
<span style="margin:0px" lang="EN-US"></span>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"><span style="font-family:Microsoft YaHei;font-size:16px;">Code</span></span>
</p>
<p style="margin:0px">
	<span style="margin:0px" lang="EN-US"></span>
</p>
<pre class="cpp" name="code">#include&lt;iostream&gt;
#include&lt;iomanip&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
#define rep(i,a,b) for(int i=a;i&lt;=b;i++)
#define dep(i,a,b) for(int i=a;i&gt;=b;i--)
#define mem(x,num) memset(x,num,sizeof x)
#define LL long long
using namespace std;
inline LL read()
{
	LL f=1,x=0;char ch=getchar();
	while(ch&lt;'0'||ch&gt;'9'){if(ch=='-')f=-1;ch=getchar();}
	while(ch&gt;='0'&amp;&amp;ch&lt;='9'){x=x*10+ch-'0';ch=getchar();}
	return x*f;
}
const int maxn=2e6+6;
LL n,m,ans,c[maxn];
vector&lt;LL&gt;e[maxn];
inline bool cmp(int a,int b){return c[a]&lt;c[b];}
void dfs(int x)
{
	for(int i=0;i&lt;e[x].size();i++)dfs(e[x][i]);
	sort(e[x].begin(),e[x].end(),cmp);
	c[x]+=e[x].size();
	for(int i=0;i&lt;e[x].size();i++){
		int t=c[e[x][i]];
		if(c[x]+t-1&lt;=m){
			c[x]+=t-1;
			ans++;
		}
		else break;
	}
}

int main()
{
	n=read(),m=read();
	rep(i,0,n-1)c[i]=read();
	rep(i,0,n-1){
		int x=read(),y;
		while(x--)y=read(),e[i].push_back(y);
	}
	dfs(0);
	printf(&quot;%lld\n&quot;,ans);
	return 0;
}</pre>
<br />

<p>
	<br />
	
</p>
